{"is_source_file": true, "format": "Python", "description": "This file defines a SecurityRepository class for managing users, roles, permissions, and their associations within an application. It interacts with a database using SQLAlchemy async ORM features, providing methods for creating, retrieving, updating, deleting, and managing relationships among security entities.", "external_files": ["src/db/models/security.py", ".base"], "external_methods": ["self.scalar_one_or_none", "self.execute", "self.scalars", "self.add", "self.commit", "self.get_user_by_email", "self.get_user_by_id", "self.get_role_by_id", "self.get_role_by_name"], "published": ["SecurityRepository"], "classes": [{"name": "SecurityRepository", "description": "Repository class for managing security-related entities and relationships such as users, roles, permissions, and their associations within a tenant."}], "methods": [{"name": "Optional[User] get_user_by_email(self, email: str)", "description": "Retrieve a User object by email address.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "Optional[User] get_user_by_id(self, user_id: UUID)", "description": "Retrieve a User object by its UUID.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "int count_users(self)", "description": "Count total number of users.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "List[User] list_users(self, limit: int = 100, offset: int = 0)", "description": "List users with optional pagination.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "User create_user( self, *, email: str, full_name: Optional[str], hashed_password: str, is_active: bool = True, is_superadmin: bool = False, )", "description": "Create a new user with specified attributes.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "Optional[User] update_user( self, user_id: UUID, *, email: Optional[str] = None, full_name: Optional[str] = None, hashed_password: Optional[str] = None, is_active: Optional[bool] = None, is_superadmin: Optional[bool] = None, )", "description": "Update attributes of an existing user identified by UUID.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "None delete_user(self, user_id: UUID)", "description": "Delete a user by UUID.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "List[Role] list_roles_for_user(self, user_id: UUID)", "description": "Retrieve roles associated with a specific user.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "List[Role] list_roles(self, limit: int = 100, offset: int = 0)", "description": "List roles with optional pagination.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "Optional[Role] get_role_by_id(self, role_id: UUID)", "description": "Retrieve a role by its UUID.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "Optional[Role] get_role_by_name(self, name: str)", "description": "Retrieve a role by its name.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "Role create_role(self, name: str, description: Optional[str] = None)", "description": "Create a new role with name and optional description.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "None delete_role(self, role_id: UUID)", "description": "Delete a role by UUID.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "Permission ensure_permission(self, code: str, description: Optional[str] = None)", "description": "Ensure a permission exists with given code; create if not present.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "None assign_role_to_user(self, user_id: UUID, role_id: UUID)", "description": "Assign a role to a user.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "None remove_role_from_user(self, user_id: UUID, role_id: UUID)", "description": "Remove a role from a user.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "None add_permission_to_role(self, role_id: UUID, permission_id: UUID)", "description": "Add a permission to a role.", "scope": "SecurityRepository", "scopeKind": "class"}, {"name": "None remove_permission_from_role(self, role_id: UUID, permission_id: UUID)", "description": "Remove a permission from a role.", "scope": "SecurityRepository", "scopeKind": "class"}], "calls": ["self.scalar_one_or_none", "self.execute", "self.scalars", "self.add", "self.commit", "self.get_user_by_email", "self.get_user_by_id", "self.get_role_by_id", "self.get_role_by_name"], "search-terms": ["SecurityRepository", "user management", "role management", "permission management", "assign role to user", "remove role from user", "ensure permission"], "state": 2, "file_id": 37, "knowledge_revision": 101, "git_revision": "6b81cec3a8cad681a0fc61e8bb08e1a1a42f0473", "revision_history": [{"86": ""}, {"101": "6b81cec3a8cad681a0fc61e8bb08e1a1a42f0473"}], "ctags": [{"_type": "tag", "name": "SecurityRepository", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^class SecurityRepository(BaseRepository):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "add_permission_to_role", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def add_permission_to_role(self, role_id: UUID, permission_id: UUID) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, role_id: UUID, permission_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "assign_role_to_user", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def assign_role_to_user(self, user_id: UUID, role_id: UUID) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, user_id: UUID, role_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "count_users", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def count_users(self) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "member", "signature": "(self)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "create_role", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def create_role(self, name: str, description: Optional[str] = None) -> Role:$/", "language": "Python", "typeref": "typename:Role", "kind": "member", "signature": "(self, name: str, description: Optional[str] = None)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def create_user($/", "language": "Python", "typeref": "typename:User", "kind": "member", "signature": "( self, *, email: str, full_name: Optional[str], hashed_password: str, is_active: bool = True, is_superadmin: bool = False, )", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "delete_role", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def delete_role(self, role_id: UUID) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, role_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "delete_user", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def delete_user(self, user_id: UUID) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, user_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "ensure_permission", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def ensure_permission(self, code: str, description: Optional[str] = None) -> Permissio/", "language": "Python", "typeref": "typename:Permission", "kind": "member", "signature": "(self, code: str, description: Optional[str] = None)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "get_role_by_id", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def get_role_by_id(self, role_id: UUID) -> Optional[Role]:$/", "language": "Python", "typeref": "typename:Optional[Role]", "kind": "member", "signature": "(self, role_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "get_role_by_name", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def get_role_by_name(self, name: str) -> Optional[Role]:$/", "language": "Python", "typeref": "typename:Optional[Role]", "kind": "member", "signature": "(self, name: str)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "get_user_by_email", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def get_user_by_email(self, email: str) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "member", "signature": "(self, email: str)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "get_user_by_id", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def get_user_by_id(self, user_id: UUID) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "member", "signature": "(self, user_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "list_roles", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def list_roles(self, limit: int = 100, offset: int = 0) -> List[Role]:$/", "language": "Python", "typeref": "typename:List[Role]", "kind": "member", "signature": "(self, limit: int = 100, offset: int = 0)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "list_roles_for_user", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def list_roles_for_user(self, user_id: UUID) -> List[Role]:$/", "language": "Python", "typeref": "typename:List[Role]", "kind": "member", "signature": "(self, user_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "list_users", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def list_users(self, limit: int = 100, offset: int = 0) -> List[User]:$/", "language": "Python", "typeref": "typename:List[User]", "kind": "member", "signature": "(self, limit: int = 100, offset: int = 0)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "remove_permission_from_role", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def remove_permission_from_role(self, role_id: UUID, permission_id: UUID) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, role_id: UUID, permission_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "remove_role_from_user", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def remove_role_from_user(self, user_id: UUID, role_id: UUID) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, user_id: UUID, role_id: UUID)", "scope": "SecurityRepository", "scopeKind": "class"}, {"_type": "tag", "name": "update_user", "path": "/home/kavia/workspace/code-generation/manufacturing-cloud-suite-159949-159959/manufacturing_api/src/repositories/security.py", "pattern": "/^    async def update_user($/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "member", "signature": "( self, user_id: UUID, *, email: Optional[str] = None, full_name: Optional[str] = None, hashed_password: Optional[str] = None, is_active: Optional[bool] = None, is_superadmin: Optional[bool] = None, )", "scope": "SecurityRepository", "scopeKind": "class"}], "hash": "dab0496c50f7fe4d217540aeb03f9e94", "format-version": 4, "code-base-name": "manufacturing_api", "filename": "manufacturing_api/src/repositories/security.py"}